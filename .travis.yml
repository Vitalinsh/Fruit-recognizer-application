jobs:
  include:
      - stage: test
        language: python
        python:
        - "3.6"
        services:
        - docker

        before_install:
        - docker build -t recognitron .
        # command to install dependencies
        install:
        - pip install -r requirements.txt
        - pip install pylint_runner
        # - pip install flake8
            # command to run tests
        script:
        - pytest
        # - flake8
        - docker run -d -p 4000:80 recognitron

      - stage: test
        language: android
        jdk: oraclejdk8
        android:
        components:
            #- tools
            #- platform-tools
            #- build-tools-28.0.3
            #- android-28
            #- extra
        services:
        - docker

        after_failure:
        # dump the last 2000 lines of our build, and hope the error is in that!
        - tail --lines=2000 build.log

        after_success:
        # Log that the build worked, because we all need some good news
        - echo "Buildroot build succeeded, binary in ./build"

        before_install:
        - cd client
        - docker build -q -t recognitronandroidapp .

        script:
        # - ./gradlew build connectedCheck
        - docker run --rm -v “$PWD”:/home/gradle/ -w /home/gradle/Recognitron/android-build:part1 gradle -PdisablePreDex RecognitronApp

